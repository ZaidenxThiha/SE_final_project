@model List<AWEfinal.DAL.Models.Product>
@{
    ViewData["Title"] = "Products";
    var categories = ViewBag.Categories as string[] ?? new[] { "All", "Smartphones", "Laptops", "Tablets", "Headphones", "Smart TVs", "Cameras", "Smartwatches", "Gaming Consoles", "Speakers", "Monitors" };
    var selectedCategory = ViewBag.SelectedCategory as string ?? "All";
}

<h2>Products</h2>

<div class="row mb-3">
    <div class="col-md-12">
        <form method="get" asp-action="Index" class="d-flex gap-2 align-items-center">
            <label for="category" class="form-label mb-0">Category:</label>
            <select name="category" id="category" class="form-select" style="width: auto;">
                @foreach (var cat in categories)
                {
                    <option value="@cat" selected="@(selectedCategory == cat)">@cat</option>
                }
            </select>
            <button type="submit" class="btn btn-primary">Filter</button>
            <a href="@Url.Action("Index", "Product")" class="btn btn-secondary">Clear Filter</a>
        </form>
    </div>
</div>

@if (Model == null || !Model.Any())
{
    <div class="alert alert-info">
        <p>No products found in this category.</p>
        <a href="@Url.Action("Index", "Product")" class="btn btn-primary">View All Products</a>
    </div>
}
else
{
    <div class="row">
        @foreach (var product in Model)
        {
            <div class="col-md-3 mb-4">
                <div class="card h-100 shadow-sm">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">@product.Name</h5>
                        <p class="card-text text-muted">@product.Category</p>
                        <p class="card-text"><strong class="text-primary fs-4">$@product.Price.ToString("N2")</strong></p>
                        <div class="mt-auto">
                            <a href="@Url.Action("Details", "Product", new { id = product.Id })" class="btn btn-primary btn-sm w-100 mb-2">View Details</a>
                            <a href="@Url.Action("AddToCart", "Cart", new { productId = product.Id })" class="btn btn-success btn-sm w-100">Add to Cart</a>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
}

